<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>GLib.test_trap_fork</title>
<link rel="stylesheet" type="text/css" href="C.css">
<script type="text/javascript" src="jquery.js"></script><script type="text/javascript" src="jquery.syntax.js"></script><script type="text/javascript" src="yelp.js"></script>
</head>
<body><div class="page" role="main">
<div class="header"><div class="trails" role="navigation"><div class="trail">
<a class="trail" href="index.html" title="GLib">GLib</a> » </div></div></div>
<div class="body">
<div class="hgroup"><h1 class="title"><span class="title">GLib.test_trap_fork</span></h1></div>
<div class="region">
<div class="contents">
<div class="synopsis"><div class="inner"><div class="region"><div class="contents"><div class="code"><pre class="contents ">function test_trap_fork(usec_timeout: Number(guint64), test_trap_flags: <span class="link"><a href="GLib.TestTrapFlags.html" title="GLib.TestTrapFlags">GLib.TestTrapFlags</a></span>): Boolean {
    // Gjs wrapper for g_test_trap_fork()
}
  </pre></div></div></div></div></div>
<p class="p">Fork the current test program to execute a test case that might
not return or that might abort.</p>
<p class="p">If <span class="code">usec_timeout</span> is non-0, the forked test case is aborted and
considered failing if its run time exceeds it.</p>
<p class="p">The forking behavior can be configured with the <span class="link"><a href="GLib.TestTrapFlags.html" title="GLib.TestTrapFlags">GLib.TestTrapFlags</a></span> flags.</p>
<p class="p">In the following example, the test code forks, the forked child
process produces some sample output and exits successfully.
The forking parent process then asserts successful child program
termination and validates child program outputs.</p>
<p class="p">|[&lt;!-- language="C" --&gt;
  static void
  test_fork_patterns (void)
  {
    if (g_test_trap_fork (0, G_TEST_TRAP_SILENCE_STDOUT | G_TEST_TRAP_SILENCE_STDERR))
      {
        g_print ("some stdout text: somagic17\n");
        g_printerr ("some stderr text: semagic43\n");
        exit (0); // successful test run
      }
    g_test_trap_assert_passed ();
    g_test_trap_assert_stdout ("*somagic17*");
    g_test_trap_assert_stderr ("*semagic43*");
  }
]|</p>
<p class="p">Since 2.16</p>
<div class="terms"><div class="inner"><div class="region"><dl class="terms">
<dt class="terms"><span class="code">usec_timeout</span></dt>
<dd class="terms"><p class="p">Timeout for the forked test in micro seconds.</p></dd>
<dt class="terms"><span class="code">test_trap_flags</span></dt>
<dd class="terms"><p class="p">Flags to modify forking behaviour.</p></dd>
<dt class="terms"><span class="code">Returns</span></dt>
<dd class="terms"><p class="p"><span class="code">true</span> for the forked child and <span class="code">false</span> for the executing parent process.</p></dd>
</dl></div></div></div>
</div>
<div class="sect sect-links" role="navigation">
<div class="hgroup"></div>
<div class="contents"><div class="links guidelinks"><div class="inner">
<div class="title"><h2><span class="title">More Information</span></h2></div>
<div class="region"><ul><li class="links "><a href="index.html" title="GLib">GLib</a></li></ul></div>
</div></div></div>
</div>
</div>
<div class="clear"></div>
</div>
<div class="footer"></div>
</div></body>
</html>
