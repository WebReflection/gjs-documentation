<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Gio.ApplicationCommandLine</title>
<link rel="stylesheet" type="text/css" href="C.css">
<script type="text/javascript" src="jquery.js"></script><script type="text/javascript" src="jquery.syntax.js"></script><script type="text/javascript" src="yelp.js"></script>
</head>
<body><div class="page" role="main">
<div class="header"><div class="trails" role="navigation"><div class="trail">
<a class="trail" href="index.html" title="Gio">Gio</a> » </div></div></div>
<div class="body">
<div class="hgroup"><h1 class="title"><span class="title">Gio.ApplicationCommandLine</span></h1></div>
<div class="region">
<div class="contents">
<div class="synopsis"><div class="inner"><div class="region"><div class="contents"><div class="code"><pre class="contents ">const Gio = imports.gi.Gio;

let applicationCommandLine = new Gio.ApplicationCommandLine({
    <span class="link"><a href="Gio.ApplicationCommandLine-arguments.html" title="Gio.ApplicationCommandLine.arguments">arguments</a></span>: value,
    <span class="link"><a href="Gio.ApplicationCommandLine-options.html" title="Gio.ApplicationCommandLine.options">options</a></span>: value,
    <span class="link"><a href="Gio.ApplicationCommandLine-platform-data.html" title="Gio.ApplicationCommandLine.platform_data">platform_data</a></span>: value,
});
  </pre></div></div></div></div></div>
<p class="p"><span class="link"><a href="Gio.ApplicationCommandLine.html" title="Gio.ApplicationCommandLine">Gio.ApplicationCommandLine</a></span> represents a command-line invocation of
an application.  It is created by <span class="link"><a href="Gio.Application.html" title="Gio.Application">Gio.Application</a></span> and emitted
in the <span class="link"><a href="Gio.Application-command-line.html" title="Gio.Application::command-line">Gio.Application::command-line</a></span> signal and virtual function.</p>
<p class="p">The class contains the list of arguments that the program was invoked
with.  It is also possible to query if the commandline invocation was
local (ie: the current process is running in direct response to the
invocation) or remote (ie: some other process forwarded the
commandline to this process).</p>
<p class="p">The GApplicationCommandLine object can provide the @argc and @argv
parameters for use with the <span class="link"><a href="../GLib-2.0/GLib.OptionContext.html" title="../GLib-2.0/GLib.OptionContext.html">GLib.OptionContext</a></span> command-line parsing API,
with the <span class="link"><a href="Gio.ApplicationCommandLine.get_arguments.html" title="Gio.ApplicationCommandLine.prototype.get_arguments">Gio.ApplicationCommandLine.prototype.get_arguments</a></span> function. See
[gapplication-example-cmdline3.c][gapplication-example-cmdline3]
for an example.</p>
<p class="p">The exit status of the originally-invoked process may be set and
messages can be printed to stdout or stderr of that process.  The
lifecycle of the originally-invoked process is tied to the lifecycle
of this object (ie: the process exits when the last reference is
dropped).</p>
<p class="p">The main use for <span class="link"><a href="Gio.ApplicationCommandLine.html" title="Gio.ApplicationCommandLine">Gio.ApplicationCommandLine</a></span> (and the
<span class="link"><a href="Gio.Application-command-line.html" title="Gio.Application::command-line">Gio.Application::command-line</a></span> signal) is 'Emacs server' like use cases:
You can set the `EDITOR` environment variable to have e.g. git use
your favourite editor to edit commit messages, and if you already
have an instance of the editor running, the editing will happen
in the running instance, instead of opening a new one. An important
aspect of this use case is that the process that gets started by git
does not return until the editing is done.</p>
<p class="p">Normally, the commandline is completely handled in the
<span class="link"><a href="Gio.Application-command-line.html" title="Gio.Application::command-line">Gio.Application::command-line</a></span> handler. The launching instance exits
once the signal handler in the primary instance has returned, and
the return value of the signal handler becomes the exit status
of the launching instance.
|[&lt;!-- language="C" --&gt;
static int
command_line (GApplication            *application,
              GApplicationCommandLine *cmdline)
{
  gchar **argv;
  gint argc;
  gint i;</p>
<p class="p">  argv = g_application_command_line_get_arguments (cmdline, &amp;argc);</p>
<p class="p">  g_application_command_line_print (cmdline,
                                    "This text is written back\n"
                                    "to stdout of the caller\n");</p>
<p class="p">  for (i = 0; i &lt; argc; i++)
    g_print ("argument %d: %s\n", i, argv[i]);</p>
<p class="p">  g_strfreev (argv);</p>
<p class="p">  return 0;
}
]|
The complete example can be found here:
[gapplication-example-cmdline.c](https://git.gnome.org/browse/glib/tree/gio/tests/gapplication-example-cmdline.c)</p>
<p class="p">In more complicated cases, the handling of the comandline can be
split between the launcher and the primary instance.
|[&lt;!-- language="C" --&gt;
static gboolean
 test_local_cmdline (GApplication   *application,
                     gchar        ***arguments,
                     gint           *exit_status)
{
  gint i, j;
  gchar **argv;</p>
<p class="p">  argv = *arguments;</p>
<p class="p">  i = 1;
  while (argv[i])
    {
      if (g_str_has_prefix (argv[i], "--local-"))
        {
          g_print ("handling argument %s locally\n", argv[i]);
          g_free (argv[i]);
          for (j = i; argv[j]; j++)
            argv[j] = argv[j + 1];
        }
      else
        {
          g_print ("not handling argument %s locally\n", argv[i]);
          i++;
        }
    }</p>
<p class="p">  *exit_status = 0;</p>
<p class="p">  return FALSE;
}</p>
<p class="p">static void
test_application_class_init (TestApplicationClass *class)
{
  G_APPLICATION_CLASS (class)-&gt;local_command_line = test_local_cmdline;</p>
<p class="p">  ...
}
]|
In this example of split commandline handling, options that start
with `--local-` are handled locally, all other options are passed
to the <span class="link"><a href="Gio.Application-command-line.html" title="Gio.Application::command-line">Gio.Application::command-line</a></span> handler which runs in the primary
instance.</p>
<p class="p">The complete example can be found here:
[gapplication-example-cmdline2.c](https://git.gnome.org/browse/glib/tree/gio/tests/gapplication-example-cmdline2.c)</p>
<p class="p">If handling the commandline requires a lot of work, it may
be better to defer it.
|[&lt;!-- language="C" --&gt;
static gboolean
my_cmdline_handler (gpointer data)
{
  GApplicationCommandLine *cmdline = data;</p>
<p class="p">  // do the heavy lifting in an idle</p>
<p class="p">  g_application_command_line_set_exit_status (cmdline, 0);
  g_object_unref (cmdline); // this releases the application</p>
<p class="p">  return G_SOURCE_REMOVE;
}</p>
<p class="p">static int
command_line (GApplication            *application,
              GApplicationCommandLine *cmdline)
{
  // keep the application running until we are done with this commandline
  g_application_hold (application);</p>
<p class="p">  g_object_set_data_full (G_OBJECT (cmdline),
                          "application", application,
                          (GDestroyNotify)g_application_release);</p>
<p class="p">  g_object_ref (cmdline);
  g_idle_add (my_cmdline_handler, cmdline);</p>
<p class="p">  return 0;
}
]|
In this example the commandline is not completely handled before
the <span class="link"><a href="Gio.Application-command-line.html" title="Gio.Application::command-line">Gio.Application::command-line</a></span> handler returns. Instead, we keep
a reference to the <span class="link"><a href="Gio.ApplicationCommandLine.html" title="Gio.ApplicationCommandLine">Gio.ApplicationCommandLine</a></span> object and handle it
later (in this example, in an idle). Note that it is necessary to
hold the application until you are done with the commandline.</p>
<p class="p">The complete example can be found here:
[gapplication-example-cmdline3.c](https://git.gnome.org/browse/glib/tree/gio/tests/gapplication-example-cmdline3.c)</p>
<div class="synopsis"><div class="inner">
<div class="title title-synopsis"><h2><span class="title">Hierarchy</span></h2></div>
<div class="region"><div class="contents"><div class="tree"><div class="inner"><div class="region"><ul class="tree"><li class="tree">
<div>
        <span class="code">GObject.Object</span>
      
      </div>
<ul class="tree"><li class="tree"><div>
        <span class="code">Gio.ApplicationCommandLine</span>
      </div></li></ul>
</li></ul></div></div></div></div></div>
</div></div>
<div class="links topiclinks"><div class="inner">
<div class="title title-links"><h2><span class="title">Methods</span></h2></div>
<div class="region"><ul>
<li class="links "><a href="Gio.ApplicationCommandLine.create_file_for_arg.html" title="Gio.ApplicationCommandLine.prototype.create_file_for_arg">Gio.ApplicationCommandLine.prototype.create_file_for_arg</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine.get_arguments.html" title="Gio.ApplicationCommandLine.prototype.get_arguments">Gio.ApplicationCommandLine.prototype.get_arguments</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine.get_cwd.html" title="Gio.ApplicationCommandLine.prototype.get_cwd">Gio.ApplicationCommandLine.prototype.get_cwd</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine.get_environ.html" title="Gio.ApplicationCommandLine.prototype.get_environ">Gio.ApplicationCommandLine.prototype.get_environ</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine.get_exit_status.html" title="Gio.ApplicationCommandLine.prototype.get_exit_status">Gio.ApplicationCommandLine.prototype.get_exit_status</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine.get_is_remote.html" title="Gio.ApplicationCommandLine.prototype.get_is_remote">Gio.ApplicationCommandLine.prototype.get_is_remote</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine.get_options_dict.html" title="Gio.ApplicationCommandLine.prototype.get_options_dict">Gio.ApplicationCommandLine.prototype.get_options_dict</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine.get_platform_data.html" title="Gio.ApplicationCommandLine.prototype.get_platform_data">Gio.ApplicationCommandLine.prototype.get_platform_data</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine.get_stdin.html" title="Gio.ApplicationCommandLine.prototype.get_stdin">Gio.ApplicationCommandLine.prototype.get_stdin</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine.getenv.html" title="Gio.ApplicationCommandLine.prototype.getenv">Gio.ApplicationCommandLine.prototype.getenv</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine.set_exit_status.html" title="Gio.ApplicationCommandLine.prototype.set_exit_status">Gio.ApplicationCommandLine.prototype.set_exit_status</a></li>
</ul></div>
</div></div>
<div class="links topiclinks"><div class="inner">
<div class="title title-links"><h2><span class="title">Properties</span></h2></div>
<div class="region"><ul>
<li class="links "><a href="Gio.ApplicationCommandLine-arguments.html" title="Gio.ApplicationCommandLine.arguments">arguments</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine-is-remote.html" title="Gio.ApplicationCommandLine.is_remote">is-remote</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine-options.html" title="Gio.ApplicationCommandLine.options">options</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine-platform-data.html" title="Gio.ApplicationCommandLine.platform_data">platform-data</a></li>
</ul></div>
</div></div>
<div class="links topiclinks"><div class="inner">
<div class="title title-links"><h2><span class="title">Virtual functions</span></h2></div>
<div class="region"><ul>
<li class="links "><a href="Gio.ApplicationCommandLine-get_stdin.html" title="Gio.ApplicationCommandLine::get_stdin">Gio.ApplicationCommandLine::get_stdin</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine-print_literal.html" title="Gio.ApplicationCommandLine::print_literal">Gio.ApplicationCommandLine::print_literal</a></li>
<li class="links "><a href="Gio.ApplicationCommandLine-printerr_literal.html" title="Gio.ApplicationCommandLine::printerr_literal">Gio.ApplicationCommandLine::printerr_literal</a></li>
</ul></div>
</div></div>
</div>
<div class="sect sect-links" role="navigation">
<div class="hgroup"></div>
<div class="contents"><div class="links guidelinks"><div class="inner">
<div class="title"><h2><span class="title">More Information</span></h2></div>
<div class="region"><ul><li class="links "><a href="index.html" title="Gio">Gio</a></li></ul></div>
</div></div></div>
</div>
</div>
<div class="clear"></div>
</div>
<div class="footer"></div>
</div></body>
</html>
