<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Gio.SimpleAsyncResult</title>
<link rel="stylesheet" type="text/css" href="C.css">
<script type="text/javascript" src="jquery.js"></script><script type="text/javascript" src="jquery.syntax.js"></script><script type="text/javascript" src="yelp.js"></script>
</head>
<body><div class="page" role="main">
<div class="header"><div class="trails" role="navigation"><div class="trail">
<a class="trail" href="index.html" title="Gio">Gio</a> » </div></div></div>
<div class="body">
<div class="hgroup"><h1 class="title"><span class="title">Gio.SimpleAsyncResult</span></h1></div>
<div class="region">
<div class="contents">
<div class="synopsis"><div class="inner"><div class="region"><div class="contents"><div class="code"><pre class="contents ">const Gio = imports.gi.Gio;

let simpleAsyncResult = new Gio.SimpleAsyncResult();
  </pre></div></div></div></div></div>
<p class="p">As of GLib 2.36, <span class="link"><a href="Gio.SimpleAsyncResult.html" title="Gio.SimpleAsyncResult">Gio.SimpleAsyncResult</a></span> is deprecated in favor of
<span class="link"><a href="Gio.Task.html" title="Gio.Task">Gio.Task</a></span>, which provides a simpler API.</p>
<p class="p"><span class="link"><a href="Gio.SimpleAsyncResult.html" title="Gio.SimpleAsyncResult">Gio.SimpleAsyncResult</a></span> implements <span class="link"><a href="Gio.AsyncResult.html" title="Gio.AsyncResult">Gio.AsyncResult</a></span>.</p>
<p class="p">GSimpleAsyncResult handles #GAsyncReadyCallbacks, error
reporting, operation cancellation and the final state of an operation,
completely transparent to the application. Results can be returned
as a pointer e.g. for functions that return data that is collected
asynchronously, a boolean value for checking the success or failure
of an operation, or a #gssize for operations which return the number
of bytes modified by the operation; all of the simple return cases
are covered.</p>
<p class="p">Most of the time, an application will not need to know of the details
of this API; it is handled transparently, and any necessary operations
are handled by <span class="link"><a href="Gio.AsyncResult.html" title="Gio.AsyncResult">Gio.AsyncResult</a></span>'s interface. However, if implementing a
new GIO module, for writing language bindings, or for complex
applications that need better control of how asynchronous operations
are completed, it is important to understand this functionality.</p>
<p class="p">GSimpleAsyncResults are tagged with the calling function to ensure
that asynchronous functions and their finishing functions are used
together correctly.</p>
<p class="p">To create a new <span class="link"><a href="Gio.SimpleAsyncResult.html" title="Gio.SimpleAsyncResult">Gio.SimpleAsyncResult</a></span>, call <span class="link"><a href="Gio.SimpleAsyncResult.new.html" title="Gio.SimpleAsyncResult.new">Gio.SimpleAsyncResult.new</a></span>.
If the result needs to be created for a <span class="link"><a href="../GLib-2.0/GLib.Error.html" title="../GLib-2.0/GLib.Error.html">GLib.Error</a></span>, use
<span class="link"><a href="Gio.SimpleAsyncResult.new_from_error.html" title="Gio.SimpleAsyncResult.new_from_error">Gio.SimpleAsyncResult.new_from_error</a></span> or
<span class="link"><a href="Gio.SimpleAsyncResult.new_take_error.html" title="Gio.SimpleAsyncResult.new_take_error">Gio.SimpleAsyncResult.new_take_error</a></span>. If a <span class="link"><a href="../GLib-2.0/GLib.Error.html" title="../GLib-2.0/GLib.Error.html">GLib.Error</a></span> is not available
(e.g. the asynchronous operation's doesn't take a <span class="link"><a href="../GLib-2.0/GLib.Error.html" title="../GLib-2.0/GLib.Error.html">GLib.Error</a></span> argument),
but the result still needs to be created for an error condition, use
<span class="link"><a href="Gio.SimpleAsyncResult.new_error.html" title="Gio.SimpleAsyncResult.new_error">Gio.SimpleAsyncResult.new_error</a></span> (or <span class="link"><a href="Gio.SimpleAsyncResult.set_error_va.html" title="Gio.SimpleAsyncResult.set_error_va">Gio.SimpleAsyncResult.set_error_va</a></span>
if your application or binding requires passing a variable argument list
directly), and the error can then be propagated through the use of
<span class="link"><a href="Gio.SimpleAsyncResult.propagate_error.html" title="Gio.SimpleAsyncResult.prototype.propagate_error">Gio.SimpleAsyncResult.prototype.propagate_error</a></span>.</p>
<p class="p">An asynchronous operation can be made to ignore a cancellation event by
calling <span class="link"><a href="Gio.SimpleAsyncResult.set_handle_cancellation.html" title="Gio.SimpleAsyncResult.prototype.set_handle_cancellation">Gio.SimpleAsyncResult.prototype.set_handle_cancellation</a></span> with a
<span class="link"><a href="Gio.SimpleAsyncResult.html" title="Gio.SimpleAsyncResult">Gio.SimpleAsyncResult</a></span> for the operation and <span class="code">false</span>. This is useful for
operations that are dangerous to cancel, such as close (which would
cause a leak if cancelled before being run).</p>
<p class="p">GSimpleAsyncResult can integrate into GLib's event loop, <span class="link"><a href="../GLib-2.0/GLib.MainLoop.html" title="../GLib-2.0/GLib.MainLoop.html">GLib.MainLoop</a></span>,
or it can use #GThreads.
<span class="link"><a href="Gio.SimpleAsyncResult.complete.html" title="Gio.SimpleAsyncResult.prototype.complete">Gio.SimpleAsyncResult.prototype.complete</a></span> will finish an I/O task directly
from the point where it is called. <span class="link"><a href="Gio.SimpleAsyncResult.complete_in_idle.html" title="Gio.SimpleAsyncResult.prototype.complete_in_idle">Gio.SimpleAsyncResult.prototype.complete_in_idle</a></span>
will finish it from an idle handler in the
[thread-default main context][g-main-context-push-thread-default]
. <span class="link"><a href="Gio.SimpleAsyncResult.run_in_thread.html" title="Gio.SimpleAsyncResult.run_in_thread">Gio.SimpleAsyncResult.run_in_thread</a></span> will run the
job in a separate thread and then deliver the result to the
thread-default main context.</p>
<p class="p">To set the results of an asynchronous function,
<span class="link"><a href="Gio.SimpleAsyncResult.set_op_res_gpointer.html" title="Gio.SimpleAsyncResult.set_op_res_gpointer">Gio.SimpleAsyncResult.set_op_res_gpointer</a></span>,
<span class="link"><a href="Gio.SimpleAsyncResult.set_op_res_gboolean.html" title="Gio.SimpleAsyncResult.prototype.set_op_res_gboolean">Gio.SimpleAsyncResult.prototype.set_op_res_gboolean</a></span>, and
<span class="link"><a href="Gio.SimpleAsyncResult.set_op_res_gssize.html" title="Gio.SimpleAsyncResult.prototype.set_op_res_gssize">Gio.SimpleAsyncResult.prototype.set_op_res_gssize</a></span>
are provided, setting the operation's result to a gpointer, gboolean, or
gssize, respectively.</p>
<p class="p">Likewise, to get the result of an asynchronous function,
<span class="link"><a href="Gio.SimpleAsyncResult.get_op_res_gpointer.html" title="Gio.SimpleAsyncResult.get_op_res_gpointer">Gio.SimpleAsyncResult.get_op_res_gpointer</a></span>,
<span class="link"><a href="Gio.SimpleAsyncResult.get_op_res_gboolean.html" title="Gio.SimpleAsyncResult.prototype.get_op_res_gboolean">Gio.SimpleAsyncResult.prototype.get_op_res_gboolean</a></span>, and
<span class="link"><a href="Gio.SimpleAsyncResult.get_op_res_gssize.html" title="Gio.SimpleAsyncResult.prototype.get_op_res_gssize">Gio.SimpleAsyncResult.prototype.get_op_res_gssize</a></span> are
provided, getting the operation's result as a gpointer, gboolean, and
gssize, respectively.</p>
<p class="p">For the details of the requirements implementations must respect, see
<span class="link"><a href="Gio.AsyncResult.html" title="Gio.AsyncResult">Gio.AsyncResult</a></span>.  A typical implementation of an asynchronous operation
using GSimpleAsyncResult looks something like this:</p>
<p class="p">|[&lt;!-- language="C" --&gt;
static void
baked_cb (Cake    *cake,
          gpointer user_data)
{
  // In this example, this callback is not given a reference to the cake,
  // so the GSimpleAsyncResult has to take a reference to it.
  GSimpleAsyncResult *result = user_data;</p>
<p class="p">  if (cake == NULL)
    g_simple_async_result_set_error (result,
                                     BAKER_ERRORS,
                                     BAKER_ERROR_NO_FLOUR,
                                     "Go to the supermarket");
  else
    g_simple_async_result_set_op_res_gpointer (result,
                                               g_object_ref (cake),
                                               g_object_unref);</p>
<p class="p">
  // In this example, we assume that baked_cb is called as a callback from
  // the mainloop, so it's safe to complete the operation synchronously here.
  // If, however, _baker_prepare_cake () might call its callback without
  // first returning to the mainloop — inadvisable, but some APIs do so —
  // we would need to use <span class="link"><a href="Gio.SimpleAsyncResult.complete_in_idle.html" title="Gio.SimpleAsyncResult.prototype.complete_in_idle">Gio.SimpleAsyncResult.prototype.complete_in_idle</a></span>.
  g_simple_async_result_complete (result);
  g_object_unref (result);
}</p>
<p class="p">void
baker_bake_cake_async (Baker              *self,
                       guint               radius,
                       GAsyncReadyCallback callback,
                       gpointer            user_data)
{
  GSimpleAsyncResult *simple;
  Cake               *cake;</p>
<p class="p">  if (radius &lt; 3)
    {
      g_simple_async_report_error_in_idle (G_OBJECT (self),
                                           callback,
                                           user_data,
                                           BAKER_ERRORS,
                                           BAKER_ERROR_TOO_SMALL,
                                           "%ucm radius cakes are silly",
                                           radius);
      return;
    }</p>
<p class="p">  simple = g_simple_async_result_new (G_OBJECT (self),
                                      callback,
                                      user_data,
                                      baker_bake_cake_async);
  cake = _baker_get_cached_cake (self, radius);</p>
<p class="p">  if (cake != NULL)
    {
      g_simple_async_result_set_op_res_gpointer (simple,
                                                 g_object_ref (cake),
                                                 g_object_unref);
      g_simple_async_result_complete_in_idle (simple);
      g_object_unref (simple);
      // Drop the reference returned by _baker_get_cached_cake();
      // the GSimpleAsyncResult has taken its own reference.
      g_object_unref (cake);
      return;
    }</p>
<p class="p">  _baker_prepare_cake (self, radius, baked_cb, simple);
}</p>
<p class="p">Cake *
baker_bake_cake_finish (Baker        *self,
                        GAsyncResult *result,
                        GError      **error)
{
  GSimpleAsyncResult *simple;
  Cake               *cake;</p>
<p class="p">  g_return_val_if_fail (g_simple_async_result_is_valid (result,
                                                        G_OBJECT (self),
                                                        baker_bake_cake_async),
                        NULL);</p>
<p class="p">  simple = (GSimpleAsyncResult *) result;</p>
<p class="p">  if (g_simple_async_result_propagate_error (simple, error))
    return NULL;</p>
<p class="p">  cake = CAKE (g_simple_async_result_get_op_res_gpointer (simple));
  return g_object_ref (cake);
}
]|</p>
<div class="synopsis"><div class="inner">
<div class="title title-synopsis"><h2><span class="title">Hierarchy</span></h2></div>
<div class="region"><div class="contents"><div class="tree"><div class="inner"><div class="region"><ul class="tree"><li class="tree">
<div>
        <span class="code">GObject.Object</span>
      
      </div>
<ul class="tree"><li class="tree"><div>
        <span class="code">Gio.SimpleAsyncResult</span>
      </div></li></ul>
</li></ul></div></div></div></div></div>
</div></div>
<div class="links topiclinks"><div class="inner">
<div class="title title-links"><h2><span class="title">Constructors</span></h2></div>
<div class="region"><ul>
<li class="links "><a href="Gio.SimpleAsyncResult.new.html" title="Gio.SimpleAsyncResult.new">Gio.SimpleAsyncResult.new</a></li>
<li class="links "><a href="Gio.SimpleAsyncResult.new_from_error.html" title="Gio.SimpleAsyncResult.new_from_error">Gio.SimpleAsyncResult.new_from_error</a></li>
</ul></div>
</div></div>
<div class="links topiclinks"><div class="inner">
<div class="title title-links"><h2><span class="title">Methods</span></h2></div>
<div class="region"><ul>
<li class="links "><a href="Gio.SimpleAsyncResult.complete.html" title="Gio.SimpleAsyncResult.prototype.complete">Gio.SimpleAsyncResult.prototype.complete</a></li>
<li class="links "><a href="Gio.SimpleAsyncResult.complete_in_idle.html" title="Gio.SimpleAsyncResult.prototype.complete_in_idle">Gio.SimpleAsyncResult.prototype.complete_in_idle</a></li>
<li class="links "><a href="Gio.SimpleAsyncResult.get_op_res_gboolean.html" title="Gio.SimpleAsyncResult.prototype.get_op_res_gboolean">Gio.SimpleAsyncResult.prototype.get_op_res_gboolean</a></li>
<li class="links "><a href="Gio.SimpleAsyncResult.get_op_res_gssize.html" title="Gio.SimpleAsyncResult.prototype.get_op_res_gssize">Gio.SimpleAsyncResult.prototype.get_op_res_gssize</a></li>
<li class="links "><a href="Gio.SimpleAsyncResult.get_op_res_gvalue.html" title="Gio.SimpleAsyncResult.prototype.get_op_res_gvalue">Gio.SimpleAsyncResult.prototype.get_op_res_gvalue</a></li>
<li class="links "><a href="Gio.SimpleAsyncResult.propagate_error.html" title="Gio.SimpleAsyncResult.prototype.propagate_error">Gio.SimpleAsyncResult.prototype.propagate_error</a></li>
<li class="links "><a href="Gio.SimpleAsyncResult.set_check_cancellable.html" title="Gio.SimpleAsyncResult.prototype.set_check_cancellable">Gio.SimpleAsyncResult.prototype.set_check_cancellable</a></li>
<li class="links "><a href="Gio.SimpleAsyncResult.set_from_error.html" title="Gio.SimpleAsyncResult.prototype.set_from_error">Gio.SimpleAsyncResult.prototype.set_from_error</a></li>
<li class="links "><a href="Gio.SimpleAsyncResult.set_handle_cancellation.html" title="Gio.SimpleAsyncResult.prototype.set_handle_cancellation">Gio.SimpleAsyncResult.prototype.set_handle_cancellation</a></li>
<li class="links "><a href="Gio.SimpleAsyncResult.set_op_res_gboolean.html" title="Gio.SimpleAsyncResult.prototype.set_op_res_gboolean">Gio.SimpleAsyncResult.prototype.set_op_res_gboolean</a></li>
<li class="links "><a href="Gio.SimpleAsyncResult.set_op_res_gssize.html" title="Gio.SimpleAsyncResult.prototype.set_op_res_gssize">Gio.SimpleAsyncResult.prototype.set_op_res_gssize</a></li>
<li class="links "><a href="Gio.SimpleAsyncResult.set_op_res_gvalue.html" title="Gio.SimpleAsyncResult.prototype.set_op_res_gvalue">Gio.SimpleAsyncResult.prototype.set_op_res_gvalue</a></li>
</ul></div>
</div></div>
<div class="links topiclinks"><div class="inner">
<div class="title title-links"><h2><span class="title">Static Functions</span></h2></div>
<div class="region"><ul><li class="links "><a href="Gio.SimpleAsyncResult.is_valid.html" title="Gio.SimpleAsyncResult.is_valid">Gio.SimpleAsyncResult.is_valid</a></li></ul></div>
</div></div>
</div>
<div class="sect sect-links" role="navigation">
<div class="hgroup"></div>
<div class="contents"><div class="links guidelinks"><div class="inner">
<div class="title"><h2><span class="title">More Information</span></h2></div>
<div class="region"><ul><li class="links "><a href="index.html" title="Gio">Gio</a></li></ul></div>
</div></div></div>
</div>
</div>
<div class="clear"></div>
</div>
<div class="footer"></div>
</div></body>
</html>
