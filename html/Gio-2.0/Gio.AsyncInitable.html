<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Gio.AsyncInitable</title>
<link rel="stylesheet" type="text/css" href="C.css">
<script type="text/javascript" src="jquery.js"></script><script type="text/javascript" src="jquery.syntax.js"></script><script type="text/javascript" src="yelp.js"></script>
</head>
<body><div class="page" role="main">
<div class="header"><div class="trails" role="navigation"><div class="trail">
<a class="trail" href="index.html" title="Gio">Gio</a> » </div></div></div>
<div class="body">
<div class="hgroup"><h1 class="title"><span class="title">Gio.AsyncInitable</span></h1></div>
<div class="region">
<div class="contents">
<div class="synopsis"><div class="inner"><div class="region"><div class="contents"><div class="code"><pre class="contents ">const Gio = imports.gi.Gio;

let async_initable = new Gio.AsyncInitable();
  </pre></div></div></div></div></div>
<p class="p">This is the asynchronous version of <span class="link"><a href="Gio.Initable.html" title="Gio.Initable">Gio.Initable</a></span>; it behaves the same
in all ways except that initialization is asynchronous. For more details
see the descriptions on <span class="link"><a href="Gio.Initable.html" title="Gio.Initable">Gio.Initable</a></span>.</p>
<p class="p">A class may implement both the <span class="link"><a href="Gio.Initable.html" title="Gio.Initable">Gio.Initable</a></span> and <span class="link"><a href="Gio.AsyncInitable.html" title="Gio.AsyncInitable">Gio.AsyncInitable</a></span> interfaces.</p>
<p class="p">Users of objects implementing this are not intended to use the interface
method directly; instead it will be used automatically in various ways.
For C applications you generally just call <span class="link"><a href="Gio.AsyncInitable.new_async.html" title="Gio.AsyncInitable.new_async">Gio.AsyncInitable.new_async</a></span>
directly, or indirectly via a foo_thing_new_async() wrapper. This will call
<span class="link"><a href="Gio.AsyncInitable.init_async.html" title="Gio.AsyncInitable.prototype.init_async">Gio.AsyncInitable.prototype.init_async</a></span> under the cover, calling back with <span class="code">null</span> and
a set %GError on failure.</p>
<p class="p">A typical implementation might look something like this:</p>
<p class="p">|[&lt;!-- language="C" --&gt;
enum {
   NOT_INITIALIZED,
   INITIALIZING,
   INITIALIZED
};</p>
<p class="p">static void
_foo_ready_cb (Foo *self)
{
  GList *l;</p>
<p class="p">  self-&gt;priv-&gt;state = INITIALIZED;</p>
<p class="p">  for (l = self-&gt;priv-&gt;init_results; l != NULL; l = l-&gt;next)
    {
      GTask *task = l-&gt;data;</p>
<p class="p">      if (self-&gt;priv-&gt;success)
        g_task_return_boolean (task, TRUE);
      else
        g_task_return_new_error (task, ...);
      g_object_unref (task);
    }</p>
<p class="p">  g_list_free (self-&gt;priv-&gt;init_results);
  self-&gt;priv-&gt;init_results = NULL;
}</p>
<p class="p">static void
foo_init_async (GAsyncInitable       *initable,
                int                   io_priority,
                GCancellable         *cancellable,
                GAsyncReadyCallback   callback,
                gpointer              user_data)
{
  Foo *self = FOO (initable);
  GTask *task;</p>
<p class="p">  task = g_task_new (initable, cancellable, callback, user_data);</p>
<p class="p">  switch (self-&gt;priv-&gt;state)
    {
      case NOT_INITIALIZED:
        _foo_get_ready (self);
        self-&gt;priv-&gt;init_results = g_list_append (self-&gt;priv-&gt;init_results,
                                                  task);
        self-&gt;priv-&gt;state = INITIALIZING;
        break;
      case INITIALIZING:
        self-&gt;priv-&gt;init_results = g_list_append (self-&gt;priv-&gt;init_results,
                                                  task);
        break;
      case INITIALIZED:
        if (!self-&gt;priv-&gt;success)
          g_task_return_new_error (task, ...);
        else
          g_task_return_boolean (task, TRUE);
        g_object_unref (task);
        break;
    }
}</p>
<p class="p">static gboolean
foo_init_finish (GAsyncInitable       *initable,
                 GAsyncResult         *result,
                 GError              **error)
{
  g_return_val_if_fail (g_task_is_valid (result, initable), FALSE);</p>
<p class="p">  return g_task_propagate_boolean (G_TASK (result), error);
}</p>
<p class="p">static void
foo_async_initable_iface_init (gpointer g_iface,
                               gpointer data)
{
  GAsyncInitableIface *iface = g_iface;</p>
<p class="p">  iface-&gt;init_async = foo_init_async;
  iface-&gt;init_finish = foo_init_finish;
}
]|</p>
<p class="p">Since 2.22</p>
<div class="synopsis"><div class="inner">
<div class="title title-synopsis"><h2><span class="title">Prerequisites</span></h2></div>
<div class="region"><div class="contents"><p class="p">AsyncInitable requires GObject.Object</p></div></div>
</div></div>
<div class="synopsis"><div class="inner">
<div class="title title-synopsis"><h2><span class="title">Known Implementations</span></h2></div>
<div class="region"><div class="contents"><p class="p">AsyncInitable is implemented by DBusConnection, DBusObjectManagerClient and DBusProxy</p></div></div>
</div></div>
<div class="links topiclinks"><div class="inner">
<div class="title title-links"><h2><span class="title">Methods</span></h2></div>
<div class="region"><ul>
<li class="links "><a href="Gio.AsyncInitable.init_async.html" title="Gio.AsyncInitable.prototype.init_async">Gio.AsyncInitable.prototype.init_async</a></li>
<li class="links "><a href="Gio.AsyncInitable.init_finish.html" title="Gio.AsyncInitable.prototype.init_finish">Gio.AsyncInitable.prototype.init_finish</a></li>
<li class="links "><a href="Gio.AsyncInitable.new_finish.html" title="Gio.AsyncInitable.prototype.new_finish">Gio.AsyncInitable.prototype.new_finish</a></li>
</ul></div>
</div></div>
<div class="links topiclinks"><div class="inner">
<div class="title title-links"><h2><span class="title">Static Functions</span></h2></div>
<div class="region"><ul><li class="links "><a href="Gio.AsyncInitable.newv_async.html" title="Gio.AsyncInitable.newv_async">Gio.AsyncInitable.newv_async</a></li></ul></div>
</div></div>
<div class="links topiclinks"><div class="inner">
<div class="title title-links"><h2><span class="title">Virtual functions</span></h2></div>
<div class="region"><ul>
<li class="links "><a href="Gio.AsyncInitable-init_async.html" title="Gio.AsyncInitable::init_async">Gio.AsyncInitable::init_async</a></li>
<li class="links "><a href="Gio.AsyncInitable-init_finish.html" title="Gio.AsyncInitable::init_finish">Gio.AsyncInitable::init_finish</a></li>
</ul></div>
</div></div>
</div>
<div class="sect sect-links" role="navigation">
<div class="hgroup"></div>
<div class="contents"><div class="links guidelinks"><div class="inner">
<div class="title"><h2><span class="title">More Information</span></h2></div>
<div class="region"><ul><li class="links "><a href="index.html" title="Gio">Gio</a></li></ul></div>
</div></div></div>
</div>
</div>
<div class="clear"></div>
</div>
<div class="footer"></div>
</div></body>
</html>
